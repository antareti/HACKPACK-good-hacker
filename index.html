<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Hacker 3D ‚Äî CMD Emulator (#FF4500)</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;800&display=swap" rel="stylesheet">
<style>
  :root{
    --accent:#FF4500;
    --bg:#0b0b0f;
    --bg-soft:#0f1117;
    --fg:#e6e6e6;
    --muted:#9aa4b2;
    --glass: rgba(255,69,0,0.08);
    --shadow: 0 10px 30px rgba(255,69,0,0.15), 0 2px 10px rgba(0,0,0,0.5);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--fg);
    font-family:'JetBrains Mono',ui-monospace,Consolas,Menlo,monospace;
    background:
      radial-gradient(1200px 600px at 70% -10%, rgba(255,69,0,0.15), transparent 60%),
      radial-gradient(800px 500px at -20% 90%, rgba(255,69,0,0.12), transparent 55%),
      var(--bg);
    overflow-x:hidden;
  }

  /* –¥–µ–∫–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å—Ü–µ–Ω–∞ */
  .grid-bg{
    position:fixed; inset:0; pointer-events:none; z-index:-2;
    background: linear-gradient(transparent 24px, rgba(255,255,255,0.04) 25px),
                linear-gradient(90deg, transparent 24px, rgba(255,255,255,0.04) 25px);
    background-size:25px 25px;
    transform:perspective(900px) rotateX(55deg) translateY(-15vh);
    filter:drop-shadow(0 0 10px rgba(255,69,0,0.25));
    animation:gridFloat 14s ease-in-out infinite alternate;
  }
  @keyframes gridFloat{to{transform:perspective(900px) rotateX(60deg) translateY(-12vh) translateX(2vw)}}
  canvas#rain{position:fixed; inset:0; z-index:-3; opacity:.35}

  header{
    padding:clamp(20px,4vw,48px) 6vw 10px; display:flex; justify-content:space-between; align-items:center;
  }
  .logo{display:flex; gap:12px; align-items:center; text-decoration:none; color:var(--fg)}
  .brand{font-weight:800; letter-spacing:.08em; text-transform:uppercase; font-size:clamp(16px,2.6vw,24px)}
  .btn{
    position:relative; border:1px solid rgba(255,69,0,0.5); background:var(--glass); color:var(--fg);
    padding:10px 14px; border-radius:12px; cursor:pointer; text-decoration:none; box-shadow:var(--shadow);
  }
  .btn:hover{transform:translateY(-2px); border-color:var(--accent)}
  .hero{padding:0 6vw 22px}
  .h1{font-size:clamp(26px,6vw,56px); line-height:1.05; margin:8px 0;
      text-shadow:0 0 15px rgba(255,69,0,0.45), 0 0 2px rgba(255,69,0,.9)}
  .sub{color:var(--muted)}

  main{padding: 16px 6vw 64px; display:grid; grid-template-columns: 1fr; gap:18px}
  .panel{
    background:linear-gradient(to bottom right, rgba(255,69,0,0.08), rgba(255,69,0,0.02));
    border:1px solid rgba(255,69,0,0.5); border-radius:18px; box-shadow:var(--shadow); overflow:hidden;
  }
  .hd{
    display:flex; align-items:center; gap:10px; padding:12px 14px;
    border-bottom:1px solid rgba(255,69,0,0.35);
    background:linear-gradient( to right, rgba(255,69,0,0.08), rgba(255,69,0,0.02) );
  }
  .led{width:8px; height:8px; border-radius:999px; background:var(--accent); box-shadow:0 0 8px var(--accent), 0 0 20px rgba(255,69,0,0.8)}
  .title{font-weight:700; letter-spacing:.06em; text-transform:uppercase; font-size:.9rem}

  /* === –û–∫–Ω–æ CMD === */
  .cmd-wrap{padding:14px}
  .cmd-window{
    background:#000; color:#dcdcdc; border:1px solid #222; border-radius:10px; overflow:hidden;
    box-shadow: 0 12px 28px rgba(0,0,0,.45);
  }
  .cmd-title{
    background:#0c3c78; color:#fff; padding:6px 10px; font-size:12px; display:flex; align-items:center; justify-content:space-between;
  }
  .cmd-title .t{opacity:.95}
  .cmd-title .wbtns{display:flex; gap:6px}
  .wbtn{width:12px; height:12px; border-radius:2px; background:#e5e7eb; opacity:.9}
  .cmd-body{
    padding:10px; height:420px; overflow:auto; font-size:14px; line-height:1.35;
    font-family:Consolas, 'JetBrains Mono', monospace;
  }

  .line{white-space:pre-wrap}
  .prompt{color:#dcdcdc}
  .path{color:#9cdcfe}
  .cursor{display:inline-block; width:7px; height:1.2em; background:#dcdcdc; margin-left:1px; transform:translateY(3px); animation:blink 1.05s steps(2) infinite}
  @keyframes blink{50%{opacity:0}}

  /* –≤—ã–¥–µ–ª–µ–Ω–∏–µ/–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∫ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ */
  .cmd-body::selection, .line::selection{background:#444; color:#fff}

  footer{ padding: 18px 6vw 54px; color:var(--muted); text-align:center }
  .kbd{display:inline-flex; padding:2px 6px; border-radius:6px; border:1px solid rgba(255,255,255,0.18); background:rgba(255,255,255,0.06); font-size:.78rem}
</style>
</head>
<body>
  <div class="grid-bg"></div>
  <canvas id="rain"></canvas>

  <header>
    <a class="logo" href="#"><div class="brand">Hacker 3D</div></a>
    <div class="actions">
      <a class="btn" href="#" id="btn-full">–ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º</a>
      <a class="btn" href="#" id="btn-copy">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –±—É—Ñ–µ—Ä</a>
    </div>
  </header>

  <section class="hero">
    <h1 class="h1">üï∂Ô∏èüíª –≠–º—É–ª—è—Ç–æ—Ä <span style="color:var(--accent)">Windows CMD</span></h1>
    <p class="sub">–í–≤–æ–¥ –ø—Ä—è–º–æ –≤ —Å—Ç—Ä–æ–∫–µ, –º–∏–≥–∞—é—â–∏–π –∫—É—Ä—Å–æ—Ä, –∏—Å—Ç–æ—Ä–∏—è (‚Üë/‚Üì), —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –∑–∞–¥–µ—Ä–∂–∫–∏ –≤—ã–≤–æ–¥–∞.
      –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏: <span class="kbd">/</span> ‚Äî —Ñ–æ–∫—É—Å –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª, <span class="kbd">F</span> ‚Äî fullscreen.</p>
  </section>

  <main>
    <section class="panel">
      <div class="hd"><span class="led"></span><div class="title">–∫–æ–Ω—Å–æ–ª—å</div></div>
      <div class="cmd-wrap">
        <div class="cmd-window" id="cmdwin">
          <div class="cmd-title"><span class="t">–ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞</span><span class="wbtns"><span class="wbtn"></span><span class="wbtn"></span><span class="wbtn"></span></span></div>
          <div class="cmd-body" id="term" tabindex="0" aria-label="CMD emulator"></div>
        </div>
      </div>
    </section>
  </main>

  <footer>–°–¥–µ–ª–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –∫ <b style="color:var(--accent)">#FF4500</b>. –ü–æ–¥–∫–ª—é—á–∞–π —Ä–µ–∞–ª—å–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ ‚Äî API/–≤–µ–±—Å–æ–∫–µ—Ç—ã ‚Äî –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥.</footer>

<script>
/* ====== Matrix rain (–¥–µ–∫–æ—Ä) ====== */
(function(){
  const c = document.getElementById('rain'); const ctx = c.getContext('2d');
  function size(){ c.width = innerWidth; c.height = innerHeight; }
  size(); addEventListener('resize', size);
  const chars = '01‚ñà‚ñì‚ñë#@ŒîŒ£ŒªœÄ$%<>/\\\\;:[]{}*&^!?'.split('');
  const fontSize = 16; let drops = new Array(Math.floor(innerWidth/fontSize)).fill(1);
  (function draw(){
    ctx.fillStyle = 'rgba(11,11,15,0.08)'; ctx.fillRect(0,0,c.width,c.height);
    ctx.fillStyle = 'rgba(255,69,0,0.85)'; ctx.font = fontSize + 'px JetBrains Mono';
    drops.forEach((y,i)=>{
      const text = chars[Math.floor(Math.random()*chars.length)];
      ctx.fillText(text, i*fontSize, y*fontSize);
      if (y*fontSize > c.height && Math.random() > .975) drops[i]=0;
      drops[i] = y + 1;
    });
    requestAnimationFrame(draw);
  })();
})();

/* ====== –ü–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π —Ä–µ–∂–∏–º / copy ====== */
document.getElementById('btn-full').addEventListener('click', (e)=>{ e.preventDefault();
  if(!document.fullscreenElement){ document.documentElement.requestFullscreen().catch(()=>{}); }
  else{ document.exitFullscreen().catch(()=>{}); }
});
document.getElementById('btn-copy').addEventListener('click', (e)=>{
  e.preventDefault();
  const text = document.getElementById('term').innerText;
  navigator.clipboard?.writeText(text);
});

/* ====== –≠–º—É–ª—è—Ç–æ—Ä CMD ====== */
(function(){
  const term = document.getElementById('term');

  // --- —Å–æ—Å—Ç–æ—è–Ω–∏–µ ---
  const state = {
    path: ['C:', 'Users', 'Guest'],
    history: [],
    historyIndex: -1,
    buffer: '',
    caret: 0,
    fs: {
      'C:': {
        'Users': {
          'Guest': {
            'readme.txt': 'HACKPACK ‚Äî Good Hacker\n–í–µ—Ä—Å–∏—è 1.0\n\n–≠—Ç–æ —Å–∏–º—É–ª—è—Ç–æ—Ä CMD –¥–ª—è –≤–µ–±–∞.',
            'config.sys': 'device=himem.sys\nfiles=40\nbuffers=25',
            'projects': {
              'hacker3d': {'index.html': '<!-- your site here -->'}
            }
          }
        },
        'Windows': {'System32': {}},
        'Temp': {}
      }
    }
  };

  const nowFmt = ()=> {
    const d = new Date();
    const dd = String(d.getDate()).padStart(2,'0');
    const mm = String(d.getMonth()+1).padStart(2,'0');
    const yyyy = d.getFullYear();
    const hh = String(d.getHours()).padStart(2,'0');
    const mi = String(d.getMinutes()).padStart(2,'0');
    return `${dd}.${mm}.${yyyy}  ${hh}:${mi}`;
  };

  // helpers
  const joinPath = (arr)=> arr.join('\\');
  function getNode(pathArr){
    let node = state.fs;
    for(const part of pathArr){
      if(typeof node !== 'object' || !(part in node)) return null;
      node = node[part];
    }
    return node;
  }
  function isDir(node){ return node && typeof node === 'object' && !('length' in node); }

  // –≤—ã–≤–æ–¥
  function print(text=''){
    const div = document.createElement('div'); div.className='line';
    div.textContent = text;
    term.appendChild(div); term.scrollTop = term.scrollHeight;
  }
  function printRaw(html=''){
    const div = document.createElement('div'); div.className='line'; div.innerHTML = html;
    term.appendChild(div); term.scrollTop = term.scrollHeight;
  }
  function promptLine(){
    const line = document.createElement('div'); line.className='line'; line.id='current-line';
    const path = `<span class="path">${joinPath(state.path)}&gt;</span> `;
    line.innerHTML = `<span class="prompt">${path}</span><span id="buf-left"></span><span class="cursor"></span><span id="buf-right"></span>`;
    term.appendChild(line); term.scrollTop = term.scrollHeight;
    renderBuffer();
  }
  function renderBuffer(){
    const left = state.buffer.slice(0, state.caret);
    const right = state.buffer.slice(state.caret);
    document.getElementById('buf-left').textContent = left;
    document.getElementById('buf-right').textContent = right;
  }
  function clearScreen(){ term.innerHTML=''; }

  // –ø–∞—Ä—Å–∏–Ω–≥ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (—Å –∫–∞–≤—ã—á–∫–∞–º–∏)
  function parseArgs(s){
    const out=[]; let cur=''; let q=null;
    for(let i=0;i<s.length;i++){
      const ch=s[i];
      if(q){
        if(ch===q){ q=null; continue; }
        if(ch==='\\' && s[i+1]===q){ cur+=q; i++; continue; }
        cur+=ch;
      }else{
        if(ch==='"'||ch=="'"){ q=ch; continue; }
        if(/\s/.test(ch)){ if(cur){ out.push(cur); cur=''; } }
        else cur+=ch;
      }
    }
    if(cur) out.push(cur);
    return out;
  }

  // –∫–æ–º–∞–Ω–¥—ã
  const commands = {
    help(){
      const lines = [
        '–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –∫–æ–º–∞–Ω–¥—ã:',
        '  HELP            –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É',
        '  DIR             –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫',
        '  CD [path]       –°–º–µ–Ω–∏—Ç—å –∫–∞—Ç–∞–ª–æ–≥ (.. –¥–ª—è –≤–≤–µ—Ä—Ö)',
        '  CLS             –û—á–∏—Å—Ç–∏—Ç—å —ç–∫—Ä–∞–Ω',
        '  ECHO [text]     –í—ã–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç',
        '  TYPE [file]     –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞',
        '  IPCONFIG        –°–µ—Ç–µ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è',
        '  PING host       –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —É–∑–ª–∞'
      ];
      lines.forEach((l,i)=>setTimeout(()=>print(l), i*10));
    },
    cls(){ clearScreen(); },
    echo(...args){ print(args.join(' ')); },
    dir(){
      const node = getNode(state.path);
      if(!isDir(node)) return print('–°–∏—Å—Ç–µ–º–Ω–∞—è –æ—à–∏–±–∫–∞ –∫–∞—Ç–∞–ª–æ–≥–∞.');
      const items = Object.keys(node).sort();
      print(nowFmt());
      print('');
      let files=0, dirs=0;
      for(const name of items){
        const val = node[name];
        const isDirFlag = isDir(val);
        const size = isDirFlag ? '<DIR>' : String((val||'').length).padStart(10,' ');
        isDirFlag ? dirs++ : files++;
        print(`${nowFmt()}  ${isDirFlag?'  <DIR>       ':('          ')} ${name}${isDirFlag?'':'  ' + size}`);
      }
      print(`\n           –§–∞–π–ª–æ–≤: ${files}    –ü–∞–ø–æ–∫: ${dirs}`);
    },
    cd(pathStr=''){
      if(!pathStr){ print(joinPath(state.path)); return; }
      let parts = pathStr.replace(/\//g,'\\').split('\\').filter(Boolean);
      let newPath = [...state.path];
      if (/^[A-Za-z]:/.test(pathStr)) { // –∞–±—Å–æ–ª—é—Ç–Ω—ã–π
        newPath = [parts.shift()];
      }
      for(const p of parts){
        if(p==='..'){ if(newPath.length>1) newPath.pop(); continue; }
        const probe = getNode([...newPath, p]);
        if(!probe || !isDir(probe)){ print(`–°–∏—Å—Ç–µ–º–µ –Ω–µ —É–¥–∞–µ—Ç—Å—è –Ω–∞–π—Ç–∏ —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø—É—Ç—å.`); return; }
        newPath.push(p);
      }
      state.path = newPath;
    },
    type(filename=''){
      if(!filename){ print('–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–º—è —Ñ–∞–π–ª–∞.'); return; }
      const node = getNode([...state.path, filename]);
      if(typeof node === 'string'){ node.split('\n').forEach(l=>print(l)); }
      else print('–ù–µ —É–¥–∞–µ—Ç—Å—è –Ω–∞–π—Ç–∏ —Ñ–∞–π–ª.');
    },
    ipconfig(){
      const lines = [
        '–ù–∞—Å—Ç—Ä–æ–π–∫–∞ IP Windows',
        '',
        '–ê–¥–∞–ø—Ç–µ—Ä Ethernet:',
        '   –°—É—Ñ—Ñ–∏–∫—Å DNS-—Å—É—Ñ—Ñ–∏–∫—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è . . . . . . : local',
        '   IPv4-–∞–¥—Ä–µ—Å  . . . . . . . . . . . . . . . . : 192.168.0.101',
        '   –ú–∞—Å–∫–∞ –ø–æ–¥—Å–µ—Ç–∏ . . . . . . . . . . . . . . . : 255.255.255.0',
        '   –û—Å–Ω–æ–≤–Ω–æ–π —à–ª—é–∑ . . . . . . . . . . . . . . . : 192.168.0.1',
        ''
      ];
      lines.forEach((l,i)=>setTimeout(()=>print(l), i*80));
    },
    ping(host='8.8.8.8'){
      if(!host) { print('–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: PING —Ö–æ—Å—Ç'); return; }
      let count=0; const total=4;
      const id=setInterval(()=>{
        const ms = (Math.random()*60+20|0);
        print(`–û—Ç–≤–µ—Ç –æ—Ç ${host}: —á–∏—Å–ª–æ –±–∞–π—Ç=32 –≤—Ä–µ–º—è=${ms}–º—Å TTL=57`);
        if(++count>=total){
          clearInterval(id);
          print(`\n–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ Ping –¥–ª—è ${host}:`);
          print(`    –ü–∞–∫–µ—Ç–æ–≤: –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ = ${total}, –ø–æ–ª—É—á–µ–Ω–æ = ${total}, –ø–æ—Ç–µ—Ä—è–Ω–æ = 0 (0% –ø–æ—Ç–µ—Ä—å)`);
          print(`–ü—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ø—Ä–∏–µ–º–∞-–ø–µ—Ä–µ–¥–∞—á–∏ –≤ –º—Å:`);
          print(`    –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ = 20–º—Å, –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ = 80–º—Å, –°—Ä–µ–¥–Ω–µ–µ = 45–º—Å`);
        }
      }, 450);
    }
  };

  // –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
  function execute(line){
    const [cmdRaw, ...rest] = parseArgs(line);
    if(!cmdRaw) return;
    const cmd = cmdRaw.toLowerCase();
    const handler = commands[cmd];
    if(handler){
      // –∏–º–∏—Ç–∏—Ä—É–µ–º –∑–∞–¥–µ—Ä–∂–∫—É —Å—Ç–∞—Ä—Ç–∞ –∫–∞–∫ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—ã–≤–æ–¥–µ
      setTimeout(()=>handler(...rest), 60);
    }else{
      print(`'${cmdRaw}' –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π –∏–ª–∏ –≤–Ω–µ—à–Ω–µ–π –∫–æ–º–∞–Ω–¥–æ–π, –∏—Å–ø–æ–ª–Ω—è–µ–º–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π –∏–ª–∏ –ø–∞–∫–µ—Ç–Ω—ã–º —Ñ–∞–π–ª–æ–º.`);
    }
  }

  // –ø–µ—á–∞—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è
  (async function boot(){
    const boot = [
      'Microsoft Windows [Version 10.0.19045.4046]',
      '(c) –ö–æ—Ä–ø–æ—Ä–∞—Ü–∏—è –ú–∞–π–∫—Ä–æ—Å–æ—Ñ—Ç (Microsoft Corporation). –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.',
      ''
    ];
    for(const l of boot){ print(l); await new Promise(r=>setTimeout(r,160)); }
    promptLine();
    term.focus();
  })();

  // –≤–≤–æ–¥
  function submitCurrent(){
    // –ø–µ—á–∞—Ç–∞–µ–º –≤–≤–æ–¥ –∫–∞–∫ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Ç—Ä–æ–∫—É
    const p = document.getElementById('current-line');
    if(p){
      p.innerHTML = `<span class="prompt"><span class="path">${joinPath(state.path)}&gt;</span> </span>` + state.buffer;
    }
    const line = state.buffer;
    if(line.trim()){
      state.history.push(line);
      state.historyIndex = state.history.length;
    }
    const cmdText = line.trim();
    state.buffer=''; state.caret=0;
    execute(cmdText);
    setTimeout(promptLine, 90);
  }

  function moveCaret(delta){
    state.caret = Math.max(0, Math.min(state.buffer.length, state.caret + delta));
    renderBuffer();
  }

  term.addEventListener('keydown', (e)=>{
    // –Ω–∞–≤–∏–≥–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏
    if(e.key === 'ArrowUp'){
      if(state.history.length && state.historyIndex > 0){
        state.historyIndex--;
        state.buffer = state.history[state.historyIndex];
        state.caret = state.buffer.length;
        renderBuffer();
      }
      e.preventDefault(); return;
    }
    if(e.key === 'ArrowDown'){
      if(state.history.length && state.historyIndex < state.history.length-1){
        state.historyIndex++;
        state.buffer = state.history[state.historyIndex];
      }else{
        state.historyIndex = state.history.length;
        state.buffer = '';
      }
      state.caret = state.buffer.length;
      renderBuffer(); e.preventDefault(); return;
    }
    if(e.key === 'ArrowLeft'){ moveCaret(-1); e.preventDefault(); return; }
    if(e.key === 'ArrowRight'){ moveCaret(1); e.preventDefault(); return; }
    if(e.key === 'Home'){ state.caret=0; renderBuffer(); e.preventDefault(); return; }
    if(e.key === 'End'){ state.caret=state.buffer.length; renderBuffer(); e.preventDefault(); return; }

    if(e.key === 'Backspace'){
      if(state.caret>0){
        state.buffer = state.buffer.slice(0,state.caret-1) + state.buffer.slice(state.caret);
        state.caret--; renderBuffer();
      }
      e.preventDefault(); return;
    }
    if(e.key === 'Delete'){
      if(state.caret < state.buffer.length){
        state.buffer = state.buffer.slice(0,state.caret) + state.buffer.slice(state.caret+1);
        renderBuffer();
      }
      e.preventDefault(); return;
    }
    if(e.key === 'Enter'){ submitCurrent(); e.preventDefault(); return; }

    if(e.ctrlKey || e.metaKey) return; // –¥–∞—ë–º —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å/–≤—Å—Ç–∞–≤–∏—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ
    if(e.key.length === 1){
      state.buffer = state.buffer.slice(0,state.caret) + e.key + state.buffer.slice(state.caret);
      state.caret++; renderBuffer(); e.preventDefault(); return;
    }
  });

  // –≤—Å—Ç–∞–≤–∫–∞ –º—ã—à—å—é/Ctrl+V
  term.addEventListener('paste', (e)=>{
    const text = (e.clipboardData || window.clipboardData).getData('text');
    if(text){
      const clean = text.replace(/\r/g,'');
      state.buffer = state.buffer.slice(0,state.caret) + clean + state.buffer.slice(state.caret);
      state.caret += clean.length; renderBuffer();
      e.preventDefault();
    }
  });

  // —Ñ–æ–∫—É—Å –ø–æ "/"
  window.addEventListener('keydown', (e)=>{ if(e.key === '/'){ e.preventDefault(); term.focus(); } });
  // F ‚Äî fullscreen
  window.addEventListener('keydown', (e)=>{
    if(e.key.toLowerCase()==='f'){
      if(!document.fullscreenElement){ document.documentElement.requestFullscreen().catch(()=>{}); }
      else{ document.exitFullscreen().catch(()=>{}); }
    }
  });
})();
</script>
</body>
</html>
